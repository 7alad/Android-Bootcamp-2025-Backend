# Android-Bootcamp-2025-Backend

## Команда: Нет минусов, одни си плюс плюсы

Разработать программный продукт для помощи в осуществлении волонтерской деятельности в клиент-серверной архитектуре.

Клиент - Android Приложение, реализованное на java или kotlin с адаптивной версткой.
Мобильное приложение должно предоставлять удобный и интуитивно понятный интерфейс для волонтеров, в котором можно
зарегистрироваться в базу волонтеров, просмотреть ближайшие волонтерские центры, отредактировать собственный профиль и
посмотреть активных волонтеров в конкретном центре. В случае авторизации с правами администратора, пользователь
приложения должен иметь возможность просмотреть список не занятых волонтеров и их контактные данные.

Сервер - микросервис на Spring Boot, работающий с In-memory базой данных H2.
Серверное приложение должно предоставлять API необходимый для работы мобильного приложения. Осуществлять все основные
манипуляции с данными в СУБД при помощи Spring Data JPA. Данные о всех зарегистрированных волонтерских центрах должны
быть предзаполнены в БД при запуске приложения.Создание схемы БД и предзаполнение данными необходимо реализовать с
использованием liquibase.

### User Stories

#### Волонтёр

- Я хочу зарегистрироваться в системе для доступа к приложению;
- Я хочу авторизоваться, чтобы получить доступ к своему профилю;
- Я хочу видеть ближайшие волонтерские центры и расстояние до них, чтобы я мог вступить в удобный для меня центр;
- Я хочу видеть информацию о конкретном волонтёрском центре (название, контактные данные, описание, расстояние до него,
  событиях, в которых участвует центр), чтобы у меня была общая информация о центре;
- Я хочу видеть список активных волонтёров в конкретном центре, чтобы я мог связаться с ними;
- Я хочу редактировать информацию о себе (имя, город, увлечения, наличие водительских прав и т.д.), чтобы моя информация
  была актуальной;
<!-- 
- Я хочу иметь возможность вступить в конкретный волонтерский центр, чтобы числиться занятым (активным) пользователем. 
-->

#### Админ

- Я хочу просматривать список не занятых волонтеров и их контактные данные, чтобы связаться с ними;
<!--
#### Админ (владелец определенного волонтерского центра)
- Я хочу менять информацию о своём волонтерском центре;
- Я хочу исключить волонтёра из списка активных (занятых) в своём центре;
- Я хочу иметь возможность отправить приглашение определённому волонтеру, чтобы пополнять ряды своей организации.
-->

### Use Cases
#### Волонтёр

1. **Цель:** создание аккаунта в системе  
   **Участник:** волонтёр  
   **Предусловия:** ---  
   **Основной поток:**
    - Ввод имени, фамилии, даты рождения, email, телефона, пароля, повторного пароля и ввод/выбор города;
    - Отправка POST запроса на сервер (`api/v1/auth/register`)
    - Получение и сохранение в локальное хранилище токена
    - Переход на главный экран (Важно, чтобы при нажатии кнопки назад экран авторизации не показывался повторно)

   **Альтернативный поток:**
    - Если при нажатии кнопки "Создать аккаунт" любое из полей пустое, то мы подкрашиваем это поле светло-красным
      цветом. Красный цвет должен исчезать при вводе.
    - Если сервер возвращает ответ `409`, то выводим Snackbar "Пользователь с такими данными уже существует!"
    - Если первое поле с паролем заполнено, то второе поле должно сравнивать пароли по мере ввода текста. Если они не
      совпадают подсвечивать поле с повторным паролем светло-красным цветом.
    - Если с сервера не пришел ответ, отобразить информацию об ошибке сервера/интернета.


2. **Цель:** авторизация пользователя  
   **Участник:** волонтёр  
   **Предусловия:** учетная запись создана  
   **Основной поток:**
    - Ввод email и пароля;
    - Отправка POST запроса на сервер (`api/v1/auth/login`)
    - Получение и сохранение в локальное хранилище токена
    - Переход на главный экран (Важно, чтобы при нажатии кнопки назад экран авторизации не показывался повторно)

   **Альтернативный поток:**
    - Если при нажатии кнопки "Войти" поле email или пароля пустые, то мы подкрашиваем это поле светло-красным цветом.
      Красный цвет должен исчезать при вводе.
    - Если от сервера пришел ответ `404`, то мы выводим Snackbar "Некорректный email или пароль!".
    - Если с сервера не пришел ответ, отобразить информацию об ошибке сервера/интернета.


3. **Цель:** получить информацию о ближайших к пользователю волонтерских центрах  
   **Участник:** волонтер  
   **Предусловия:** учётная запись создана  
   **Основной поток:**
    - Отправка GET запроса на сервер (`api/v1/centers`)
    - Получение и обработка списка волонтёрских центров в городе
    - Вывод информации на экран (на экране должна быть функция обновления экрана)

   **Альтернативный поток:**
    - Если пришел ответ со статусом `401` это означает, что пользователь не зарегистрирован/токен просрочен. В этом
      случае надо отправить запрос к `api/v1/auth/refresh`, обновить токен и попробовать заново отправить
      `api/v1/centers`.
    - Если с сервера не пришел ответ, отобразить информацию о ошибке сервера/интернета.


4. **Дополнение:** Это совмещенный use case. Сверху экрана будет информация о волонтерском центре, снизу список с
   активными волонтерами. (ещё лучше оставить место на экране под кнопку "показать на карте")  

   **Цель:** получение информации о конкретном центре и волонтерах, которые там работают  
   **Участник:** волонтер  
   **Предусловия:** выполнена аутентификация  
   **Основной поток:**
    - Отправка GET запроса на сервер (`api/v1/centers/{centerId}/info`)
    - Отправка GET запроса на сервер (`api/v1/centers/{centerId}/volunteers`)
    - Получение информации о центре, скачивание логотипа волонтерского центра
    - Получение информации о активных волонтерах
    - Вывод информации на экран (на экране должна быть функция обновления экрана)

   **Альтернативный поток:**
    - Если пришел ответ со статусом `404` то выводим Snackbar "Такого центра не существует"
    - Если пришел ответ со статусом `401` это означает, что пользователь не зарегистрирован/токен просрочен. В этом
      случае надо отправить запрос к `api/v1/auth/refresh`, обновить токен и попробовать ещё раз.
    - Если с сервера не пришел ответ, отобразить информацию об ошибке сервера/интернета.


5. **Цель:** актуализация информации волонтера  
   **Участник:** волонтер  
   **Предусловия:** учётная запись создана  
   **Основной поток:**
    - Внесение изменений в данные пользователя
    - Нажатие на кнопку "Обновить"
    - Отправка UPDATE запроса на сервер (`api/v1/users/{userID}`)
    - Вывод Toast/Snakebar "Изменения сохранены"

   **Альтернативный поток:**
    - Если пришел ответ со статусом `404`, то выводим Snackbar "Такого пользователя не существует"
    - Если пришел ответ со статусом `401` это означает, что пользователь не зарегистрирован/токен просрочен. В этом
      случае надо отправить запрос к `api/v1/auth/refresh`, обновить токен и попробовать ещё раз.
    - Если с сервера не пришел ответ, отобразить информацию об ошибке сервера/интернета.


#### Админ
1. **Цель:** получение информации о не занятых волонтёрах
   **Участник:** админ
   **Предусловия:** учётная запись создана  
   **Основной поток:**
    - Отправка GET запроса на сервер (`api/v1/users/free`)
    - Получение и обработка результата
    - Вывод информации на экран (на экране должна быть функция обновления экрана)
   
   **Альтернативный поток:**
    - Если пришел ответ со статусом `401` это означает, что пользователь не зарегистрирован/токен просрочен. В этом
      случае надо отправить запрос к `api/v1/auth/refresh`, обновить токен и попробовать ещё раз.
    - Если с сервера не пришел ответ, отобразить информацию об ошибке сервера/интернета.

   
### Задачи

- [ ] Базы данных
    - [ ] Прописать архитектуру базы данных волонтеров, волонтерских центров и событий
    - [ ] Написать классы-представления для базы данных
    - [ ] Написать работу с базой данных
    - [ ] Заполнить базу данных волонтёрских центров, событий и добавить админов

- [ ] Создать эндпоинты
    - [ ] Вход-регистрация на основе токенов
        - [ ] POST `api/v1/auth/register`
        - [ ] POST `api/v1/auth/login`
        - [ ] POST `api/v1/auth/refresh`

    - [ ] GET `api/v1/centers`
        - [ ] Если у пользователя нет доступа к местоположению, то возвращает все центры в том городе, который указан в
          профиле;
        - [ ] Если пришли координаты, то сортирует центры по расстоянию до них и отправляет.

    - [ ] GET `api/v1/centers/{centerId}/info`
    - [ ] GET `api/v1/centers/{centerId}/volunteers`
    - [ ] GET `api/v1/users/{userID}`
    - [ ] UPDATE `api/v1/users/{userID}`
    - [ ] GET `api/v1/users/free`

- [ ] Прописать обработку ошибок
- [ ] Настроить JWT для аутентификации
